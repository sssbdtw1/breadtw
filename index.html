<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>( Í¡Â° ÍœÊ– Í¡Â°)å³æŸç¿°æ˜¯æ†¨ä»”!ğŸ¤£ğŸ˜‚à¼¼ ã¤ â—•_â—• à¼½ã¤ğŸ’‹ğŸ“ğŸ’‹</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* CSS æ¨£å¼ï¼šè¨­å®šåœ°åœ–é¡¯ç¤ºå€å¡Šçš„å¤§å° */
        #map {
            height: 100vh; /* è®“åœ°åœ–ä½”æ»¿æ•´å€‹è¦–çª—é«˜åº¦ */
            width: 100%;  /* è®“åœ°åœ–ä½”æ»¿æ•´å€‹è¦–çª—å¯¬åº¦ */
        }
        /* è³‡è¨Šè¦–çª—çš„æ¨£å¼èª¿æ•´ï¼Œè®“æ•…äº‹å…§å®¹æ›´æ˜“è®€ */
        .info-window-content {
            max-width: 300px;
            padding: 5px;
        }
        .info-window-content h4 {
            margin-top: 0;
            color: #C0392B; /* é¹¿æ¸¯ç´… */
        }
        .info-window-content p {
            font-size: 14px;
            line-height: 1.5;
        }
        /* è®“é é¢é‚Šè·æ­¸é›¶ */
        body {
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>

    <div id="map"></div>

    <script src="data.js"></script>

    <script>


        // *** åˆå§‹åŒ– Google åœ°åœ–å’Œæ¨™è¨˜åŠŸèƒ½ ***

        // å®£å‘Šåœ°åœ–å’Œè³‡è¨Šè¦–çª—è®Šæ•¸
        let map;
        let infoWindow; 

        // é€™æ˜¯ Google Maps API è¼‰å…¥å®Œæˆå¾Œæœƒè‡ªå‹•åŸ·è¡Œçš„å‡½å¼
        function initMap() {
            // 1. è¨­å®šé¹¿æ¸¯è€è¡—çš„ä¸­å¿ƒé»ç¶“ç·¯åº¦
            const lukangCenter = { lat: 24.0573, lng: 120.4340 };

            // 2. å»ºç«‹åœ°åœ–ç‰©ä»¶
            map = new google.maps.Map(document.getElementById("map"), {
                zoom: 17, // åˆå§‹æ”¾å¤§ç´šæ•¸
                center: lukangCenter, // åˆå§‹ä¸­å¿ƒé»
                mapTypeId: 'roadmap', // åœ°åœ–é¡å‹
            });

            // 3. å»ºç«‹ä¸€å€‹å…±ç”¨çš„è³‡è¨Šè¦–çª—
            infoWindow = new google.maps.InfoWindow();

            // 4. æ ¹æ“šè³‡æ–™é™£åˆ—ï¼Œå‰µå»ºæ‰€æœ‰æ¨™è¨˜
            lukangData.forEach(data => {
                addMarker(data);
            });
        }


// å‰µå»ºæ¨™è¨˜å’Œç¶å®šè³‡è¨Šè¦–çª—çš„å‡½å¼
function addMarker(data) {
            // 1. å‰µå»ºæ¨™è¨˜
            const marker = new google.maps.Marker({
                position: { lat: data.lat, lng: data.lng }, // ç¶“ç·¯åº¦
                map: map, // ç¶å®šåˆ°å“ªå€‹åœ°åœ–
                title: data.name, // æ¨™è¨˜çš„æç¤ºæ–‡å­—
                icon: getMarkerIcon(data.category) // æ ¹æ“šé¡åˆ¥è¨­å®šè‡ªè¨‚åœ–æ¨™
            });

            // *** æ­¥é©ŸäºŒæ–°å¢ï¼šåˆ¤æ–·æ˜¯å¦æœ‰åœ–ç‰‡ç¶²å€ï¼Œä¸¦ç”Ÿæˆåœ–ç‰‡ HTML ***
            // é€™è£¡ä½¿ç”¨äº†å…§è¯æ¨£å¼ (style="...") ç¢ºä¿åœ–ç‰‡ä¸æœƒè¶…éè³‡è¨Šè¦–çª—çš„å¯¬åº¦
            const imageHtml = data.imageUrl ? 
                `<img src="${data.imageUrl}" style="max-width:100%; height:auto; margin-bottom: 10px;" alt="${data.name}">` 
                : ''; // å¦‚æœæ²’æœ‰ç¶²å€ï¼Œå‰‡ç‚ºç©ºå­—ä¸²

            // 2. å‰µå»ºè³‡è¨Šè¦–çª—çš„ HTML å…§å®¹
            const content = `
                <div class="info-window-content">
                    ${imageHtml}
                    <h4>${data.name} (${data.category})</h4>
                    <p><strong>åœ°å€:</strong> ${data.address}</p>
                    <p><strong>æ•…äº‹/ä»‹ç´¹:</strong> ${data.story}</p>
                </div>
            `;

            // 3. ç›£è½æ¨™è¨˜çš„é»æ“Šäº‹ä»¶
            marker.addListener("click", () => {
                // é»æ“Šæ¨™è¨˜æ™‚ï¼š
                infoWindow.close(); 
                
                // è¨­å®šè³‡è¨Šè¦–çª—çš„å…§å®¹
                infoWindow.setContent(content); 
                
                // é–‹å•Ÿè³‡è¨Šè¦–çª—ä¸¦å°‡å…¶éŒ¨å®šåˆ°ç•¶å‰æ¨™è¨˜
                infoWindow.open({
                    anchor: marker,
                    map: map,
                });
            });
        }
        
        // æ ¹æ“šåœ°é»é¡å‹çµ¦äºˆä¸åŒçš„åœ–æ¨™ï¼Œè®“åœ°åœ–æ›´ç”Ÿå‹•
        function getMarkerIcon(category) {
            let iconUrl;
            switch (category) {
                case "å¤è¹Ÿ":
                    // è‡ªè¨‚åœ–æ¨™ï¼šä¾‹å¦‚ä¸€å€‹å¯ºå»Ÿæˆ–å±‹é ‚çš„åœ–æ¡ˆ
                    iconUrl = 'dot.png'; 
                    break;
                case "åº—å®¶":
                    // è‡ªè¨‚åœ–æ¨™ï¼šä¾‹å¦‚ä¸€å€‹é£Ÿç‰©æˆ–é¤å»³çš„åœ–æ¡ˆ
                    iconUrl = 'dot2.png';
                    break;
                case "è‘—ååœ°æ¨™":
                default:
                    // é è¨­åœ–æ¨™ï¼šä¾‹å¦‚ä¸€å€‹æ—…éŠæˆ–æ™¯é»çš„åœ–æ¡ˆ
                    iconUrl = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png';
                    break;
            }
            return {
                url: iconUrl,
                scaledSize: new google.maps.Size(35, 42) // åœ–æ¨™å¤§å° (å¯èª¿æ•´)
            };
        }

        // å°‡ initMap å‡½å¼æš´éœ²çµ¦å…¨åŸŸ window ç‰©ä»¶ (Google API è¼‰å…¥éœ€è¦)
        window.initMap = initMap;
    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDVIaUxpl9GD5Loo0SpKoIXiC0SsT1DROY&callback=initMap" defer></script>

</body>
</html>